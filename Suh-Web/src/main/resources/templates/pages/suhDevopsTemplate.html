<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head(title='SUH DevOps Template - SAECHAN-LAB')}"></head>
<body class="min-h-screen">
<div th:replace="~{fragments/header :: header}"></div>

<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Hero Section -->
  <section class="devops-hero relative overflow-hidden bg-gradient-to-r from-orange-200 via-amber-200 to-yellow-200 py-12 rounded-2xl mb-8 shadow-lg">
    <div class="devops-hero-overlay absolute inset-0 bg-white/20"></div>
    <div class="relative text-center px-6">
      <div class="flex justify-center gap-2 mb-4 flex-wrap">
        <span class="badge bg-amber-600/80 text-white border-amber-700">v2.7.12</span>
        <span class="badge bg-amber-600/80 text-white border-amber-700">GitHub Actions</span>
        <span class="badge bg-amber-600/80 text-white border-amber-700">9 Project Types</span>
      </div>
      <h1 class="text-3xl sm:text-4xl font-bold mb-2 flex items-center justify-center gap-3 text-gray-800">
        <i class="fa-solid fa-rocket text-amber-600"></i>
        SUH-DEVOPS-TEMPLATE
      </h1>
      <p class="text-gray-700 text-sm sm:text-base">완전 자동화된 GitHub 프로젝트 관리 템플릿</p>
      <div class="mt-4">
        <a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE" target="_blank"
           class="btn btn-sm bg-gray-800 hover:bg-gray-900 text-white border-gray-900">
          <i class="fa-brands fa-github"></i>
          GitHub
        </a>
      </div>
    </div>
  </section>

  <!-- 2단 그리드 (마법사 명령어 + 댓글 명령어) -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- 마법사 명령어 카드 -->
    <div class="card bg-base-100 shadow-lg border border-gray-200">
      <div class="card-body">
        <h2 class="card-title text-lg mb-4">
          <div class="w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center">
            <i class="fa-solid fa-wand-magic-sparkles text-amber-600"></i>
          </div>
          기존 프로젝트에 적용하기
        </h2>

        <!-- OS 선택 -->
        <fieldset class="fieldset mb-4">
          <legend class="fieldset-legend text-sm font-medium mb-3">운영체제 선택</legend>
          <div class="flex gap-4 flex-wrap">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="os" value="unix" class="radio radio-primary" checked/>
              <span>macOS / Linux</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="os" value="windows" class="radio radio-primary"/>
              <span>Windows</span>
            </label>
          </div>
        </fieldset>

        <!-- 단순 텍스트 박스 + 복사 버튼 -->
        <div class="devops-command-box flex items-center gap-3 p-4 bg-gray-100 rounded-lg border border-gray-200 mb-4">
          <code id="commandDisplay" class="flex-1 text-sm font-mono break-all text-blue-700">bash &lt;(curl -fsSL "https://raw.githubusercontent.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/main/template_integrator.sh")</code>
          <button id="copyCommandBtn" class="btn btn-primary btn-sm shrink-0">
            <i class="fa-regular fa-copy"></i> 복사
          </button>
        </div>

        <p class="text-xs text-gray-500 text-center">
          대화형 모드로 프로젝트 타입과 버전을 자동 감지합니다
        </p>
      </div>
    </div>

    <!-- 댓글 명령어 카드 -->
    <div class="card bg-base-100 shadow-lg border border-gray-200">
      <div class="card-body">
        <h2 class="card-title text-lg mb-4">
          <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
            <i class="fa-solid fa-comment text-blue-600"></i>
          </div>
          댓글 명령어
          <span class="badge badge-soft badge-info text-xs ml-1">Issue/PR</span>
        </h2>

        <!-- 탭 -->
        <div role="tablist" class="tabs tabs-border mb-4">
          <a role="tab" class="tab tab-active" data-tab="server">
            <i class="fa-solid fa-server mr-1"></i> Server
          </a>
          <a role="tab" class="tab" data-tab="app">
            <i class="fa-solid fa-mobile mr-1"></i> App Build
          </a>
          <a role="tab" class="tab" data-tab="utility">
            <i class="fa-solid fa-wrench mr-1"></i> Utility
          </a>
        </div>

        <!-- 명령어 목록 -->
        <div id="commandList" class="space-y-2 min-h-48">
        </div>
      </div>
    </div>
  </div>

  <!-- 핵심 기능 섹션 -->
  <section class="mb-8">
    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fa-solid fa-star text-amber-500"></i> 핵심 기능
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- 1. 버전 자동화 -->
      <div class="devops-feature-card card bg-base-100 border border-gray-200 cursor-pointer hover:shadow-lg transition-all"
           onclick="openFeatureModal('version')">
        <div class="card-body p-4">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-10 h-10 rounded-lg bg-blue-500 flex items-center justify-center">
              <i class="fa-solid fa-tag text-white"></i>
            </div>
            <h3 class="font-bold">버전 자동화</h3>
          </div>
          <p class="text-sm text-gray-600">main 푸시 시 자동 버전 증가 + Git 태그</p>
          <div class="text-right mt-2">
            <span class="text-xs text-blue-500">클릭하여 자세히 보기 →</span>
          </div>
        </div>
      </div>

      <!-- 2. AI 체인지로그 -->
      <div class="devops-feature-card card bg-base-100 border border-gray-200 cursor-pointer hover:shadow-lg transition-all"
           onclick="openFeatureModal('changelog')">
        <div class="card-body p-4">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center">
              <i class="fa-solid fa-robot text-white"></i>
            </div>
            <h3 class="font-bold">AI 체인지로그</h3>
          </div>
          <p class="text-sm text-gray-600">CodeRabbit 리뷰 기반 CHANGELOG 자동 생성</p>
          <div class="text-right mt-2">
            <span class="text-xs text-blue-500">클릭하여 자세히 보기 →</span>
          </div>
        </div>
      </div>

      <!-- 3. PR Preview -->
      <div class="devops-feature-card card bg-base-100 border border-gray-200 cursor-pointer hover:shadow-lg transition-all"
           onclick="openFeatureModal('preview')">
        <div class="card-body p-4">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-10 h-10 rounded-lg bg-green-500 flex items-center justify-center">
              <i class="fa-solid fa-server text-white"></i>
            </div>
            <h3 class="font-bold">PR Preview</h3>
          </div>
          <p class="text-sm text-gray-600">Issue/PR 댓글로 임시 서버 배포, 닫으면 자동 삭제</p>
          <div class="text-right mt-2">
            <span class="text-xs text-blue-500">클릭하여 자세히 보기 →</span>
          </div>
        </div>
      </div>

      <!-- 4. 이슈 자동화 -->
      <div class="devops-feature-card card bg-base-100 border border-gray-200 cursor-pointer hover:shadow-lg transition-all"
           onclick="openFeatureModal('issue')">
        <div class="card-body p-4">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-10 h-10 rounded-lg bg-amber-500 flex items-center justify-center">
              <i class="fa-solid fa-code-branch text-white"></i>
            </div>
            <h3 class="font-bold">이슈 자동화</h3>
          </div>
          <p class="text-sm text-gray-600">브랜치명/커밋 메시지 자동 제안, QA 이슈 생성</p>
          <div class="text-right mt-2">
            <span class="text-xs text-blue-500">클릭하여 자세히 보기 →</span>
          </div>
        </div>
      </div>

      <!-- 5. Flutter CI/CD -->
      <div class="devops-feature-card card bg-base-100 border border-gray-200 cursor-pointer hover:shadow-lg transition-all"
           onclick="openFeatureModal('flutter')">
        <div class="card-body p-4">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-10 h-10 rounded-lg bg-cyan-500 flex items-center justify-center">
              <i class="fa-solid fa-mobile text-white"></i>
            </div>
            <h3 class="font-bold">Flutter CI/CD</h3>
          </div>
          <p class="text-sm text-gray-600">iOS TestFlight + Android Play Store 자동 배포</p>
          <div class="text-right mt-2">
            <span class="text-xs text-blue-500">클릭하여 자세히 보기 →</span>
          </div>
        </div>
      </div>

      <!-- 6. Synology 배포 -->
      <div class="devops-feature-card card bg-base-100 border border-gray-200 cursor-pointer hover:shadow-lg transition-all"
           onclick="openFeatureModal('synology')">
        <div class="card-body p-4">
          <div class="flex items-center gap-3 mb-2">
            <div class="w-10 h-10 rounded-lg bg-indigo-500 flex items-center justify-center">
              <i class="fa-solid fa-hard-drive text-white"></i>
            </div>
            <h3 class="font-bold">Synology 배포</h3>
          </div>
          <p class="text-sm text-gray-600">Docker 기반 NAS 무중단 배포</p>
          <div class="text-right mt-2">
            <span class="text-xs text-blue-500">클릭하여 자세히 보기 →</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 자동화 흐름 -->
  <section class="mb-8">
    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fa-solid fa-diagram-project text-green-500"></i> 자동화 흐름
    </h2>

    <div class="devops-flow-card card bg-base-100 shadow-sm border border-gray-200 p-6">
      <div class="flex flex-wrap items-center justify-center gap-2 text-sm">
        <div class="badge badge-lg bg-blue-500 text-white border-blue-600">main 푸시</div>
        <i class="fa-solid fa-arrow-right text-gray-400"></i>
        <div class="badge badge-lg bg-purple-500 text-white border-purple-600">버전 증가</div>
        <i class="fa-solid fa-arrow-right text-gray-400"></i>
        <div class="badge badge-lg bg-green-500 text-white border-green-600">deploy PR 생성</div>
        <i class="fa-solid fa-arrow-right text-gray-400"></i>
        <div class="badge badge-lg bg-amber-500 text-white border-amber-600">AI 체인지로그</div>
        <i class="fa-solid fa-arrow-right text-gray-400"></i>
        <div class="badge badge-lg bg-indigo-500 text-white border-indigo-600">자동 머지</div>
        <i class="fa-solid fa-arrow-right text-gray-400"></i>
        <div class="badge badge-lg bg-red-500 text-white border-red-600">CI/CD 배포</div>
      </div>
    </div>
  </section>

  <!-- 프로젝트 타입 -->
  <section class="mb-8">
    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fa-solid fa-layer-group text-blue-500"></i> 지원 프로젝트 타입
    </h2>

    <div class="card bg-base-100 shadow-sm border border-gray-200">
      <div class="card-body p-0">
        <div class="overflow-x-auto">
          <table class="table table-zebra w-full text-sm">
            <thead>
              <tr>
                <th>타입</th>
                <th>설명</th>
                <th>버전 파일</th>
                <th>지원 기능</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code class="devops-project-code bg-green-100 px-2 py-1 rounded text-green-700">spring</code></td>
                <td>Spring Boot 백엔드</td>
                <td>build.gradle</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                    <span class="badge badge-xs badge-accent">Preview</span>
                    <span class="badge badge-xs badge-info">Synology</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-cyan-100 px-2 py-1 rounded text-cyan-700">flutter</code></td>
                <td>모바일 앱</td>
                <td>pubspec.yaml</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                    <span class="badge badge-xs badge-success">TestFlight</span>
                    <span class="badge badge-xs badge-warning">PlayStore</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-blue-100 px-2 py-1 rounded text-blue-700">react</code></td>
                <td>React 프론트엔드</td>
                <td>package.json</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                    <span class="badge badge-xs badge-info">Docker</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-purple-100 px-2 py-1 rounded text-purple-700">next</code></td>
                <td>Next.js 풀스택</td>
                <td>package.json</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                    <span class="badge badge-xs badge-info">Docker</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-amber-100 px-2 py-1 rounded text-amber-700">node</code></td>
                <td>Node.js 백엔드</td>
                <td>package.json</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                    <span class="badge badge-xs badge-info">Docker</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-indigo-100 px-2 py-1 rounded text-indigo-700">python</code></td>
                <td>Python 백엔드</td>
                <td>pyproject.toml</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                    <span class="badge badge-xs badge-accent">Preview</span>
                    <span class="badge badge-xs badge-info">Synology</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-pink-100 px-2 py-1 rounded text-pink-700">react-native</code></td>
                <td>React Native CLI</td>
                <td>Info.plist + build.gradle</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-rose-100 px-2 py-1 rounded text-rose-700">react-native-expo</code></td>
                <td>Expo CLI</td>
                <td>app.json</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                  </div>
                </td>
              </tr>
              <tr>
                <td><code class="devops-project-code bg-gray-100 px-2 py-1 rounded text-gray-700">basic</code></td>
                <td>범용 (버전만)</td>
                <td>version.yml</td>
                <td>
                  <div class="flex flex-wrap gap-1">
                    <span class="badge badge-xs badge-primary">버전</span>
                    <span class="badge badge-xs badge-secondary">AI로그</span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- Collapse 섹션들 -->
  <div class="space-y-4">
    <!-- 빠른 시작 -->
    <div class="collapse collapse-arrow bg-base-100 shadow-sm border border-gray-200">
      <input type="checkbox"/>
      <div class="collapse-title text-lg font-medium flex items-center gap-2">
        <i class="fa-solid fa-bolt text-amber-500"></i>
        빠른 시작
      </div>
      <div class="collapse-content">
        <div class="pt-4 space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- 새 프로젝트 -->
            <div class="devops-quick-start-card card bg-green-50 border border-green-200">
              <div class="card-body p-4">
                <h3 class="font-bold text-green-700 flex items-center gap-2">
                  <i class="fa-solid fa-plus"></i> 새 프로젝트
                </h3>
                <p class="text-sm text-gray-600 mt-2">GitHub에서 <strong>"Use this template"</strong> 클릭</p>
                <p class="text-xs text-gray-500 mt-1">→ 1분 내 자동 초기화 완료</p>
              </div>
            </div>
            <!-- 기존 프로젝트 -->
            <div class="devops-quick-start-card card bg-blue-50 border border-blue-200">
              <div class="card-body p-4">
                <h3 class="font-bold text-blue-700 flex items-center gap-2">
                  <i class="fa-solid fa-download"></i> 기존 프로젝트
                </h3>
                <p class="text-sm text-gray-600 mt-2">위의 <strong>마법사 명령어</strong>를 터미널에서 실행</p>
                <p class="text-xs text-gray-500 mt-1">→ 대화형으로 프로젝트 타입과 버전 자동 감지</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 필수 설정 -->
    <div class="collapse collapse-arrow bg-base-100 shadow-sm border border-gray-200">
      <input type="checkbox"/>
      <div class="collapse-title text-lg font-medium flex items-center gap-2">
        <i class="fa-solid fa-gear text-blue-500"></i>
        필수 설정
      </div>
      <div class="collapse-content">
        <div class="pt-4 space-y-4">
          <div class="alert alert-info">
            <i class="fa-solid fa-circle-info"></i>
            <span>자동 체인지로그, PR 머지 등을 사용하려면 아래 설정이 필요합니다.</span>
          </div>

          <div class="devops-command-box p-4 bg-gray-100 rounded-lg border border-gray-200">
            <p class="text-sm font-mono">1. Repository Settings → Secrets → Actions → New repository secret</p>
            <p class="text-sm font-mono">2. Name: <code class="text-blue-600">_GITHUB_PAT_TOKEN</code></p>
            <p class="text-sm font-mono">3. Value: [Personal Access Token - repo, workflow 권한]</p>
          </div>

          <div class="text-sm text-gray-600">
            <p class="font-medium mb-2">Organization 설정 (필요 시)</p>
            <ul class="list-disc list-inside space-y-1">
              <li>Settings → Actions → General</li>
              <li>✅ Allow GitHub Actions to create and approve pull requests</li>
              <li>✅ Read and write permissions</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- 문서 목록 -->
    <div class="collapse collapse-arrow bg-base-100 shadow-sm border border-gray-200">
      <input type="checkbox"/>
      <div class="collapse-title text-lg font-medium flex items-center gap-2">
        <i class="fa-solid fa-book text-purple-500"></i>
        문서 목록
      </div>
      <div class="collapse-content">
        <div class="pt-4">
          <div class="overflow-x-auto">
            <table class="table table-zebra w-full text-sm">
              <thead>
                <tr>
                  <th>문서</th>
                  <th>설명</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/TEMPLATE-INTEGRATOR.md" target="_blank" class="link link-primary">통합 스크립트 가이드</a></td>
                  <td>기존 프로젝트에 템플릿 통합</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/VERSION-CONTROL.md" target="_blank" class="link link-primary">버전 관리</a></td>
                  <td>version.yml, 자동 버전 증가</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/CHANGELOG-AUTOMATION.md" target="_blank" class="link link-primary">체인지로그 자동화</a></td>
                  <td>CodeRabbit 연동, AI 문서화</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/PR-PREVIEW.md" target="_blank" class="link link-primary">PR Preview</a></td>
                  <td>임시 서버 배포 시스템</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/FLUTTER-CICD-OVERVIEW.md" target="_blank" class="link link-primary">Flutter CI/CD</a></td>
                  <td>iOS/Android 자동 배포</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/SYNOLOGY-DEPLOYMENT-GUIDE.md" target="_blank" class="link link-primary">Synology 배포</a></td>
                  <td>Docker 기반 NAS 배포</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/ISSUE-AUTOMATION.md" target="_blank" class="link link-primary">이슈 자동화</a></td>
                  <td>Issue Helper, QA 봇</td>
                </tr>
                <tr>
                  <td><a href="https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/TROUBLESHOOTING.md" target="_blank" class="link link-primary">트러블슈팅</a></td>
                  <td>자주 발생하는 문제 해결</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- 기능 상세 Modal -->
<dialog id="featureModal" class="modal">
  <div class="modal-box max-w-2xl">
    <form method="dialog">
      <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
    </form>
    <div id="modalHeader" class="flex items-center gap-3 mb-4"></div>
    <div id="modalContent" class="space-y-4"></div>
    <div class="modal-action">
      <a id="modalDocLink" href="#" target="_blank" class="btn btn-outline btn-sm">
        <i class="fa-solid fa-book"></i> 상세 문서 보기
      </a>
      <form method="dialog">
        <button class="btn">닫기</button>
      </form>
    </div>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

<div th:replace="~{fragments/footer :: footer}"></div>

<script>
  $(document).ready(function() {
    initElements();
    setupEventHandlers();
    initTab();
    renderCommandList();
  });

  const commands = {
    unix: 'bash <(curl -fsSL "https://raw.githubusercontent.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/main/template_integrator.sh")',
    windows: 'iex (iwr -Uri "https://raw.githubusercontent.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/main/template_integrator.ps1" -UseBasicParsing).Content'
  };

  const commentCommands = {
    server: [
      { cmd: '@suh-lab server build', desc: '임시 서버 배포', icon: 'fa-server', target: 'Spring, Python' },
      { cmd: '@suh-lab server destroy', desc: '서버 삭제', icon: 'fa-trash', target: 'Spring, Python' },
      { cmd: '@suh-lab server status', desc: '서버 상태 확인', icon: 'fa-circle-info', target: 'Spring, Python' }
    ],
    app: [
      { cmd: '@suh-lab build app', desc: 'iOS + Android 빌드', icon: 'fa-mobile', target: 'Flutter' },
      { cmd: '@suh-lab apk build', desc: 'Android만 빌드', icon: 'fa-android', target: 'Flutter' },
      { cmd: '@suh-lab ios build', desc: 'iOS만 빌드', icon: 'fa-apple', target: 'Flutter' }
    ],
    utility: [
      { cmd: '@suh-lab create qa', desc: 'QA 이슈 자동 생성', icon: 'fa-clipboard-check', target: '모든 프로젝트' }
    ]
  };

  const featureDetails = {
    version: {
      title: '버전 자동화',
      icon: 'fa-tag',
      bgColor: 'bg-blue-500',
      description: 'main 브랜치에 푸시하면 자동으로 patch 버전이 증가하고 Git 태그가 생성됩니다.',
      details: [
        'version.yml 파일에서 현재 버전 관리',
        'main 푸시 시 자동으로 patch 버전 증가 (예: 1.0.0 → 1.0.1)',
        'Git 태그 자동 생성 및 푸시 (v1.0.1)',
        'deploy PR에 버전 정보 자동 포함'
      ],
      docLink: 'https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/VERSION-CONTROL.md'
    },
    changelog: {
      title: 'AI 체인지로그',
      icon: 'fa-robot',
      bgColor: 'bg-purple-500',
      description: 'CodeRabbit AI가 PR 변경사항을 분석하여 CHANGELOG.md를 자동 생성합니다.',
      details: [
        'CodeRabbit 연동으로 AI 코드 리뷰',
        'PR 머지 시 CHANGELOG.md 자동 업데이트',
        '한국어로 변경사항 요약 생성',
        '버전별 변경 이력 자동 정리'
      ],
      docLink: 'https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/CHANGELOG-AUTOMATION.md'
    },
    preview: {
      title: 'PR Preview',
      icon: 'fa-server',
      bgColor: 'bg-green-500',
      description: 'Issue나 PR에 댓글로 임시 서버를 배포하고, 닫으면 자동으로 삭제됩니다.',
      details: [
        '@suh-lab server build 댓글로 임시 서버 생성',
        'Synology NAS에 Docker 컨테이너로 배포',
        '고유 포트 자동 할당 (중복 방지)',
        'Issue/PR 닫히면 서버 자동 삭제'
      ],
      docLink: 'https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/PR-PREVIEW.md'
    },
    issue: {
      title: '이슈 자동화',
      icon: 'fa-code-branch',
      bgColor: 'bg-amber-500',
      description: '이슈 생성 시 브랜치명/커밋 메시지를 자동 제안하고, QA 이슈를 생성합니다.',
      details: [
        'Issue Helper로 브랜치명 자동 생성',
        '커밋 메시지 형식 자동 제안',
        '@suh-lab create qa로 QA 이슈 자동 생성',
        '4종 이슈 템플릿 제공 (버그, 기능, 문서, 질문)'
      ],
      docLink: 'https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/ISSUE-AUTOMATION.md'
    },
    flutter: {
      title: 'Flutter CI/CD',
      icon: 'fa-mobile',
      bgColor: 'bg-cyan-500',
      description: 'Flutter 앱을 iOS TestFlight와 Android Play Store에 자동 배포합니다.',
      details: [
        '@suh-lab build app으로 iOS+Android 동시 빌드',
        'TestFlight 자동 업로드 (iOS)',
        'Play Store 내부 테스트 자동 배포 (Android)',
        'APK/IPA 아티팩트 자동 저장'
      ],
      docLink: 'https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/FLUTTER-CICD-OVERVIEW.md'
    },
    synology: {
      title: 'Synology 배포',
      icon: 'fa-hard-drive',
      bgColor: 'bg-indigo-500',
      description: 'Synology NAS에 Docker 기반으로 무중단 배포를 수행합니다.',
      details: [
        'deploy PR 머지 시 자동 배포 트리거',
        'Docker 이미지 빌드 및 레지스트리 푸시',
        'Synology Container Manager SSH 연동',
        'Blue-Green 배포로 무중단 운영'
      ],
      docLink: 'https://github.com/Cassiiopeia/SUH-DEVOPS-TEMPLATE/blob/main/docs/SYNOLOGY-DEPLOYMENT-GUIDE.md'
    }
  };

  let currentTab = localStorage.getItem('devopsTemplateTab') || 'server';

  function initElements() {
    window.elements = {
      commandDisplay: document.getElementById('commandDisplay'),
      copyCommandBtn: document.getElementById('copyCommandBtn'),
      commandList: document.getElementById('commandList')
    };
  }

  function setupEventHandlers() {
    window.elements.copyCommandBtn.addEventListener('click', copyCommand);

    document.querySelectorAll('input[name="os"]').forEach(radio => {
      radio.addEventListener('change', updateCommand);
    });

    document.querySelectorAll('[data-tab]').forEach(tab => {
      tab.addEventListener('click', function(e) {
        e.preventDefault();
        switchTab(this.dataset.tab);
      });
    });
  }

  function initTab() {
    document.querySelectorAll('[data-tab]').forEach(t => {
      t.classList.remove('tab-active');
    });
    const activeTab = document.querySelector(`[data-tab="${currentTab}"]`);
    if (activeTab) {
      activeTab.classList.add('tab-active');
    }
  }

  function updateCommand() {
    const os = document.querySelector('input[name="os"]:checked').value;
    window.elements.commandDisplay.textContent = commands[os];
  }

  function copyCommand() {
    const text = window.elements.commandDisplay.textContent;
    navigator.clipboard.writeText(text).then(() => {
      showToast('명령어가 클립보드에 복사되었습니다!', 'positive');
    }).catch(() => {
      showToast('복사에 실패했습니다.', 'negative');
    });
  }

  function copyCommentCommand(cmd) {
    navigator.clipboard.writeText(cmd).then(() => {
      showToast('댓글 명령어가 복사되었습니다!', 'positive');
    }).catch(() => {
      showToast('복사에 실패했습니다.', 'negative');
    });
  }

  function renderCommandList() {
    const list = commentCommands[currentTab];
    const container = window.elements.commandList;
    container.innerHTML = list.map(item => `
      <div class="devops-command-item flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition-colors">
        <div class="flex items-center gap-3">
          <i class="fa-solid ${item.icon} text-gray-500 w-5"></i>
          <div>
            <code class="font-mono text-sm text-blue-600">${escapeHtml(item.cmd)}</code>
            <p class="text-xs text-gray-500">${escapeHtml(item.desc)} <span class="badge badge-ghost badge-xs">${escapeHtml(item.target)}</span></p>
          </div>
        </div>
        <button class="btn btn-ghost btn-xs" onclick="copyCommentCommand('${escapeHtml(item.cmd)}')">
          <i class="fa-regular fa-copy"></i>
        </button>
      </div>
    `).join('');
  }

  function switchTab(tab) {
    currentTab = tab;
    localStorage.setItem('devopsTemplateTab', tab);

    document.querySelectorAll('[data-tab]').forEach(t => {
      t.classList.remove('tab-active');
    });
    document.querySelector(`[data-tab="${tab}"]`).classList.add('tab-active');

    renderCommandList();
  }

  function openFeatureModal(key) {
    const feature = featureDetails[key];
    const modal = document.getElementById('featureModal');

    document.getElementById('modalHeader').innerHTML = `
      <div class="w-12 h-12 rounded-lg ${feature.bgColor} flex items-center justify-center">
        <i class="fa-solid ${feature.icon} text-white text-xl"></i>
      </div>
      <h3 class="font-bold text-xl">${feature.title}</h3>
    `;

    document.getElementById('modalContent').innerHTML = `
      <p class="text-gray-600">${feature.description}</p>
      <ul class="list-disc list-inside space-y-2 text-sm text-gray-700">
        ${feature.details.map(d => `<li>${d}</li>`).join('')}
      </ul>
    `;

    document.getElementById('modalDocLink').href = feature.docLink;
    modal.showModal();
  }

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
</script>
</body>
</html>
